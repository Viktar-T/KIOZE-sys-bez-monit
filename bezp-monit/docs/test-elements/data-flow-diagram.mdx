---
title: "Diagram przepÅ‚ywu danych w monitoringu OZE"
sidebar_position: 2
---

# Architektura przepÅ‚ywu danych w monitoringu OZE

Kompleksowy system monitorowania wykorzystuje architekturÄ™ **edgeâ€“fogâ€“cloud** do zapewnienia niezawodnoÅ›ci, szybkoÅ›ci reakcji i zaawansowanej analityki danych.

## Diagram architektury

```mermaid
graph TB
    subgraph Edge["ğŸ”¹ WARSTWA EDGE (On-Site)"]
        direction TB
        S1[âš¡ Czujniki elektryczne<br/>NapiÄ™cia, prÄ…dy, moc]
        S2[ğŸŒ¡ï¸ Czujniki Å›rodowiskowe<br/>Irradiancja, temperatura]
        S3[ğŸ“³ Czujniki wibracji<br/>Turbiny wiatrowe]
        S4[ğŸ’¨ Czujniki gazÃ³w<br/>Biogazownie]
        
        G[ğŸ”Œ Gateway IoT<br/>Raspberry Pi / Moxa<br/>Modbus RTU/TCP, OPC UA]
        
        S1 --> G
        S2 --> G
        S3 --> G
        S4 --> G
    end

    subgraph Fog["ğŸ”¸ WARSTWA FOG (Lokalny Serwer)"]
        direction TB
        SCADA[ğŸ–¥ï¸ SCADA Lokalny<br/>Ignition / WinCC]
        HIST[ğŸ“Š Historian<br/>InfluxDB / TimescaleDB<br/>Retencja: 7-30 dni]
        HMI[ğŸ“± HMI Lokalne<br/>Touchscreen<br/>Control Room]
        ANAL[ğŸ” Analityka Near-RT<br/>KPI, Alarmy<br/>Detekcja anomalii]
        
        SCADA --> HIST
        HIST --> ANAL
        SCADA --> HMI
    end

    subgraph Cloud["â˜ï¸ WARSTWA CLOUD (Data Center)"]
        direction TB
        IOT[ğŸŒ IoT Hub<br/>AWS IoT Core<br/>Azure IoT Hub]
        LAKE[ğŸ’¾ Data Lake<br/>S3 / Azure Blob<br/>Retencja: 5-10 lat]
        ML[ğŸ¤– Machine Learning<br/>Predykcja produkcji<br/>Wykrywanie anomalii]
        BI[ğŸ“ˆ Business Intelligence<br/>Grafana Cloud<br/>Power BI / Tableau]
        
        IOT --> LAKE
        LAKE --> ML
        LAKE --> BI
    end

    %% PrzepÅ‚yw danych
    G -->|MQTT/HTTPS<br/>1-15 min<br/>Zagregowane dane| SCADA
    SCADA -->|MQTT/REST<br/>15 min aggregates<br/>+ zdarzenia| IOT
    
    %% Alarmy
    G -.->|Alarmy lokalne<br/>SMS/Email| OP[ğŸ‘¤ Operator]
    ANAL -.->|Alarmy P1-P2<br/>Crityczne| OP
    
    %% UÅ¼ytkownicy
    BI --> STAKE[ğŸ‘¥ Stakeholders<br/>Inwestorzy, O&M<br/>OSP, Regulatory]
    HMI --> TECH[ğŸ”§ Technicy<br/>On-site]

    %% ProtokoÅ‚y i czÄ™stotliwoÅ›ci
    classDef edgeClass fill:#e1f5e1,stroke:#4caf50,stroke-width:3px
    classDef fogClass fill:#fff4e1,stroke:#ff9800,stroke-width:3px
    classDef cloudClass fill:#e1f0ff,stroke:#2196f3,stroke-width:3px
    
    class S1,S2,S3,S4,G edgeClass
    class SCADA,HIST,HMI,ANAL fogClass
    class IOT,LAKE,ML,BI cloudClass
```

---

## Warstwy architektury

### ğŸ”¹ Warstwa EDGE (On-Site)

**Akwizycja i wstÄ™pna obrÃ³bka danych**

- **Zbieranie danych**: 1-10 Hz z czujnikÃ³w
- **Filtracja i walidacja**: Usuwanie szumÃ³w, sprawdzanie zakresÃ³w
- **Buforowanie**: 1-48h lokalnego przechowywania
- **Lokalne alarmy**: Reakcja < 100ms dla safety-critical

**Funkcje:**
- Akwizycja surowych sygnaÅ‚Ã³w
- Normalizacja jednostek
- Store-and-forward (buforowanie podczas utraty Å‚Ä…cznoÅ›ci)
- Emergency stop i lokalne reguÅ‚y bezpieczeÅ„stwa

---

### ğŸ”¸ Warstwa FOG (Lokalny Serwer)

**Agregacja i analityka lokalna**

- **Konsolidacja**: Zbieranie z wielu ÅºrÃ³deÅ‚ edge
- **Normalizacja tagÃ³w**: Ujednolicona struktura danych
- **Retencja**: 7-30 dni szczegÃ³Å‚owych danych
- **KPI i HMI**: Operacyjne dashboardy w czasie rzeczywistym

**Funkcje:**
- Agregacja danych z dziesiÄ…tek/setek urzÄ…dzeÅ„
- Time-Series Database (InfluxDB, TimescaleDB)
- Near-real-time analytics (progi adaptacyjne, CUSUM)
- Lokalne HMI dla operatorÃ³w
- Cache i synchronizacja z cloud

---

### â˜ï¸ Warstwa CLOUD (Data Center)

**SkÅ‚adowanie dÅ‚ugoterminowe i zaawansowana analityka**

- **Retencja**: 5-10 lat danych zagregowanych
- **Machine Learning**: Predykcja, wykrywanie anomalii
- **Benchmarking**: PorÃ³wnania miÄ™dzy obiektami w portfolio
- **Integracja**: ERP, CMMS, OSP portals

**Funkcje:**
- Data Lake/Warehouse (S3, Azure Blob, Parquet)
- Modele ML (XGBoost, LSTM, autoencoders)
- Raporty biznesowe (Power BI, Tableau, Grafana Cloud)
- Fleet-wide analytics i optymalizacja O&M
- Compliance i audyty

---

## Kluczowe protokoÅ‚y i technologie

### ğŸ”Œ Komunikacja Edge
- **Modbus RTU/TCP**: Legacy, dominujÄ…cy w PV/wiatr
- **OPC UA** (IEC 62541): Nowoczesny, structured data
- **CAN Bus**: Automotive-grade, turbiny wiatrowe
- **Ethernet/IP**: PrzemysÅ‚owe sieci Ethernet

### ğŸ“¡ Transport danych
- **MQTT** (ISO/IEC 20922): Lightweight telemetry, pub-sub
  - QoS 0/1/2 dla gwarantowanego dostarczenia
  - Retained messages, Last Will Testament
- **HTTPS/REST**: Synchroniczne API calls
- **Apache Kafka**: Event streaming dla duÅ¼ych wdroÅ¼eÅ„

### ğŸ’¾ Bazy danych
- **InfluxDB**: Open-source TSDB, doskonaÅ‚a wydajnoÅ›Ä‡
- **TimescaleDB**: PostgreSQL extension dla time-series
- **AWS Timestream**: Serverless TSDB w cloud
- **Parquet**: Columnar format dla archiwizacji (kompresja 10:1)

### ğŸ”’ BezpieczeÅ„stwo
- **TLS 1.3**: Szyfrowanie end-to-end
- **X.509 certyfikaty**: Mutual authentication MQTT/OPC UA
- **VPN/VPC**: Segregacja sieci OT/IT
- **IEC 62443**: Standard cyberbezpieczeÅ„stwa przemysÅ‚owego

---

## Scenariusze awaryjne

| Scenariusz | Zachowanie systemu |
|------------|-------------------|
| **Utrata Å‚Ä…cznoÅ›ci Edge â†’ Fog** | Edge buforuje dane (do 24 h), synchronizacja po przywrÃ³ceniu |
| **Utrata Å‚Ä…cznoÅ›ci Fog â†’ Cloud** | Fog przechowuje dane (do 30 dni), synchronizacja po przywrÃ³ceniu. Alarmy lokalne dziaÅ‚ajÄ… normalnie |
| **Awaria Fog** | Edge wysyÅ‚a dane bezpoÅ›rednio do Cloud (jeÅ›li ma Å‚Ä…cznoÅ›Ä‡). Lokalne HMI niedostÄ™pne, wymagana wizyta serwisu |
| **Awaria Cloud** | Edge i Fog dziaÅ‚ajÄ… normalnie (island mode). Brak dÅ‚ugoterminowej analityki i dashboardÃ³w biznesowych, ale proces kontrolowany |

---

## Kluczowe zasady projektowe

### 1. Latency drives layering
- **Emergency stop**: < 10 ms â†’ **Edge**
- **Alarmy operacyjne**: < 1 s â†’ **Edge/Fog**
- **Dashboardy operacyjne**: < 10 s â†’ **Fog**
- **Raporty biznesowe**: < 1 min â†’ **Cloud**

### 2. Resilience
- Edge + Fog **muszÄ… dziaÅ‚aÄ‡ bez cloud** przez dniâ€“tygodnie
- Edge musi dziaÅ‚aÄ‡ **bez fog** przez godziny
- Redundancja fog dla instalacji > 10 MW

### 3. Retencja vs. koszty

| Warstwa | RozdzielczoÅ›Ä‡ | Retencja | PrzykÅ‚ad (farma 10 MW) |
|---------|---------------|----------|------------------------|
| Edge | 1â€“10 s | 1â€“48 h | 10 GB (RAM/flash) |
| Fog | 1â€“10 s | 7â€“30 dni | 500 GB (SSD/HDD) |
| Cloud | 15 min (aggregates) | 5â€“10 lat | 100 GB/rok (S3, compressed) |

### 4. Otwarte standardy
- Preferuj open-source i open standards nad vendor lock-in
- OPC UA, MQTT, InfluxDB, Grafana jako de facto standardy
- API-first design dla integracji

---

## PowiÄ…zane wykÅ‚ady

- [WykÅ‚ad 1: Architektura monitoringu](/docs/wyklady/wyklad-01-architektura-w1/02-warstwy-architektury)
- [WykÅ‚ad 3: ProtokoÅ‚y komunikacyjne](/docs/wyklady/wyklad-03-protokoly)
- [WykÅ‚ad 4: Standardy i integracja](/docs/wyklady/wyklad-04-standardy-integracja)
- [WykÅ‚ad 5: JakoÅ›Ä‡ danych i strumienie](/docs/wyklady/wyklad-05-jakosc-danych-strumienie)

